<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AI-ACCE: benchmarks/nbody.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AI-ACCE
   </div>
   <div id="projectbrief">PPN Project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_13a41d9ad64fb9ae396cb953294783cf.html">benchmarks</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">nbody.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Benchmark for the nbody problem.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;bench_common.hpp&quot;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structPlanet.html">Planet</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a598a3330b3c21701223ee0ca14316eca" id="r_a598a3330b3c21701223ee0ca14316eca"><td class="memItemLeft" align="right" valign="top"><a id="a598a3330b3c21701223ee0ca14316eca" name="a598a3330b3c21701223ee0ca14316eca"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PI</b>&#160;&#160;&#160;3.141592653589793</td></tr>
<tr class="separator:a598a3330b3c21701223ee0ca14316eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6321c9a4f727494edf637f2c5559af44" id="r_a6321c9a4f727494edf637f2c5559af44"><td class="memItemLeft" align="right" valign="top"><a id="a6321c9a4f727494edf637f2c5559af44" name="a6321c9a4f727494edf637f2c5559af44"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SOLAR_MASS</b>&#160;&#160;&#160;(4 * PI * PI)</td></tr>
<tr class="separator:a6321c9a4f727494edf637f2c5559af44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8b198f8809cbf6e5135c0a7750b3b45" id="r_ab8b198f8809cbf6e5135c0a7750b3b45"><td class="memItemLeft" align="right" valign="top"><a id="ab8b198f8809cbf6e5135c0a7750b3b45" name="ab8b198f8809cbf6e5135c0a7750b3b45"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DAYS_PER_YEAR</b>&#160;&#160;&#160;365.24</td></tr>
<tr class="separator:ab8b198f8809cbf6e5135c0a7750b3b45"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a387f6e7aab3ff5ea40077b0103d77bad" id="r_a387f6e7aab3ff5ea40077b0103d77bad"><td class="memItemLeft" align="right" valign="top"><a id="a387f6e7aab3ff5ea40077b0103d77bad" name="a387f6e7aab3ff5ea40077b0103d77bad"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>BENCHMARK_FN</b> (initialize_bodies, {({ bodies[0]=<a class="el" href="structPlanet.html">Planet</a>{ .x=0,.y=0,.z=0,.vx=0,.vy=0,.vz=0,.mass=SOLAR_MASS, };bodies[1]=<a class="el" href="structPlanet.html">Planet</a>{.x=4.84143144246472090e+00,.y=-1.16032004402742839e+00,.z=-1.03622044471123109e-01,.vx=1.66007664274403694e-03 *DAYS_PER_YEAR,.vy=7.69901118419740425e-03 *DAYS_PER_YEAR,.vz=-6.90460016972063023e-05 *DAYS_PER_YEAR,.mass=9.54791938424326609e-04 *SOLAR_MASS};bodies[2]=<a class="el" href="structPlanet.html">Planet</a>{.x=8.34336671824457987e+00,.y=4.12479856412430479e+00,.z=-4.03523417114321381e-01,.vx=-2.76742510726862411e-03 *DAYS_PER_YEAR,.vy=4.99852801234917238e-03 *DAYS_PER_YEAR,.vz=2.30417297573763929e-05 *DAYS_PER_YEAR,.mass=2.85885980666130812e-04 *SOLAR_MASS};bodies[3]=<a class="el" href="structPlanet.html">Planet</a>{.x=1.28943695621391310e+01,.y=-1.51111514016986312e+01,.z=-2.23307578892655734e-01,.vx=2.96460137564761618e-03 *DAYS_PER_YEAR,.vy=2.37847173959480950e-03 *DAYS_PER_YEAR,.vz=-2.96589568540237556e-05 *DAYS_PER_YEAR,.mass=4.36624404335156298e-05 *SOLAR_MASS};bodies[4]=<a class="el" href="structPlanet.html">Planet</a>{.x=1.53796971148509165e+01,.y=-2.59193146099879641e+01,.z=1.79258772950371181e-01,.vx=2.68067772490389322e-03 *DAYS_PER_YEAR,.vy=1.62824170038242295e-03 *DAYS_PER_YEAR,.vz=-9.51592254519715870e-05 *DAYS_PER_YEAR,.mass=5.15138902046611451e-05 *SOLAR_MASS};});}) BENCHMARK_FN(offset_momentum</td></tr>
<tr class="memdesc:a387f6e7aab3ff5ea40077b0103d77bad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the bodies. <br /></td></tr>
<tr class="separator:a387f6e7aab3ff5ea40077b0103d77bad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab721b1dc055245ac91ecbebbf25ebb68" id="r_ab721b1dc055245ac91ecbebbf25ebb68"><td class="memItemLeft" align="right" valign="top"><a id="ab721b1dc055245ac91ecbebbf25ebb68" name="ab721b1dc055245ac91ecbebbf25ebb68"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>for</b> (int i=0;i&lt; NBODIES;i++)</td></tr>
<tr class="separator:ab721b1dc055245ac91ecbebbf25ebb68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a467b9ebd45a59f3c816da0751414c3e9" id="r_a467b9ebd45a59f3c816da0751414c3e9"><td class="memItemLeft" align="right" valign="top"><a id="a467b9ebd45a59f3c816da0751414c3e9" name="a467b9ebd45a59f3c816da0751414c3e9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>BENCHMARK_FN</b> (advance, { for(int iter=0;iter&lt; NB_ITERS;iter++) { for(int i=0;i&lt; NBODIES;i++) { <a class="el" href="structPlanet.html">Planet</a> *b=&amp;(bodies[i]);for(int j=i+1;j&lt; NBODIES;j++) { <a class="el" href="structPlanet.html">Planet</a> *b2=&amp;(bodies[j]);double dx=b-&gt;x - b2-&gt;x;double dy=b-&gt;y - b2-&gt;y;double dz=b-&gt;z - b2-&gt;z;double distanced=dx *dx+dy *dy+dz *dz;double distance=sqrt(distanced);double mag=0.01/(distanced *distance);b-&gt;vx -=dx *b2-&gt;mass *mag;b-&gt;vy -=dy *b2-&gt;mass *mag;b-&gt;vz -=dz *b2-&gt;mass *mag;b2-&gt;vx+=dx *b-&gt;mass *mag;b2-&gt;vy+=dy *b-&gt;mass *mag;b2-&gt;vz+=dz *b-&gt;mass *mag;} } for(int i=0;i&lt; NBODIES;i++) { <a class="el" href="structPlanet.html">Planet</a> *b=&amp;(bodies[i]);b-&gt;x+=0.01 *b-&gt;vx;b-&gt;y+=0.01 *b-&gt;vy;b-&gt;z+=0.01 *b-&gt;vz;} } }) volatile double energy_result</td></tr>
<tr class="separator:a467b9ebd45a59f3c816da0751414c3e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7c4fd67d016f580bba7b09c773613bc" id="r_af7c4fd67d016f580bba7b09c773613bc"><td class="memItemLeft" align="right" valign="top"><a id="af7c4fd67d016f580bba7b09c773613bc" name="af7c4fd67d016f580bba7b09c773613bc"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>BENCHMARK_FN</b> (energy, { double e=0.0;for(int i=0;i&lt; NBODIES;i++) { <a class="el" href="structPlanet.html">Planet</a> *b=&amp;(bodies[i]);e+=0.5 *b-&gt;mass *(b-&gt;vx *b-&gt;vx+b-&gt;vy *b-&gt;vy+b-&gt;vz *b-&gt;vz);for(int j=i+1;j&lt; NBODIES;j++) { <a class="el" href="structPlanet.html">Planet</a> *b2=&amp;(bodies[j]);double dx=b-&gt;x - b2-&gt;x;double dy=b-&gt;y - b2-&gt;y;double dz=b-&gt;z - b2-&gt;z;double distance=sqrt(dx *dx+dy *dy+dz *dz);e -=(b-&gt;mass *b2-&gt;mass)/distance;} } energy_result=e;}) const expr int PAIRS</td></tr>
<tr class="separator:af7c4fd67d016f580bba7b09c773613bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad53b0d94ac3415c89e387f84592cabd" id="r_aad53b0d94ac3415c89e387f84592cabd"><td class="memItemLeft" align="right" valign="top"><a id="aad53b0d94ac3415c89e387f84592cabd" name="aad53b0d94ac3415c89e387f84592cabd"></a>
__m256d r[PAIRS+3]&#160;</td><td class="memItemRight" valign="bottom"><b>__attribute__</b> ((aligned(sizeof(__m256d))))</td></tr>
<tr class="separator:aad53b0d94ac3415c89e387f84592cabd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aace273ed49bb5375a1f8e369e4a27539" id="r_aace273ed49bb5375a1f8e369e4a27539"><td class="memItemLeft" align="right" valign="top"><a id="aace273ed49bb5375a1f8e369e4a27539" name="aace273ed49bb5375a1f8e369e4a27539"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>BENCHMARK_FN</b> (initialize_bodies_simd, { masses[0]=SOLAR_MASS;positions[0]=_mm256_set1_pd(0.0);velocities[0]=_mm256_set1_pd(0.0);masses[1]=9.54791938424326609e-04 *SOLAR_MASS;positions[1]=_mm256_setr_pd(0.0, 4.84143144246472090e+00, -1.16032004402742839e+00, -1.03622044471123109e-01);velocities[1]=_mm256_setr_pd(0.0, 1.66007664274403694e-03 *DAYS_PER_YEAR, 7.69901118419740425e-03 *DAYS_PER_YEAR, -6.90460016972063023e-05 *DAYS_PER_YEAR);masses[2]=2.85885980666130812e-04 *SOLAR_MASS;positions[2]=_mm256_setr_pd(0.0, 8.34336671824457987e+00, 4.12479856412430479e+00, -4.03523417114321381e-01);velocities[2]=_mm256_setr_pd(0.0, -2.76742510726862411e-03 *DAYS_PER_YEAR, 4.99852801234917238e-03 *DAYS_PER_YEAR, 2.30417297573763929e-05 *DAYS_PER_YEAR);masses[3]=4.36624404335156298e-05 *SOLAR_MASS;positions[3]=_mm256_setr_pd(0.0, 1.28943695621391310e+01, -1.51111514016986312e+01, -2.23307578892655734e-01);velocities[3]=_mm256_setr_pd(0.0, 2.96460137564761618e-03 *DAYS_PER_YEAR, 2.37847173959480950e-03 *DAYS_PER_YEAR, -2.96589568540237556e-05 *DAYS_PER_YEAR);masses[4]=5.15138902046611451e-05 *SOLAR_MASS;positions[4]=_mm256_setr_pd(0.0, 1.53796971148509165e+01, -2.59193146099879641e+01, 1.79258772950371181e-01);velocities[4]=_mm256_setr_pd(0.0, 2.68067772490389322e-03 *DAYS_PER_YEAR, 1.62824170038242295e-03 *DAYS_PER_YEAR, -9.51592254519715870e-05 *DAYS_PER_YEAR);}) BENCHMARK_FN(rsqrt_simd</td></tr>
<tr class="separator:aace273ed49bb5375a1f8e369e4a27539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6227222ec220dcda67673e40b29a443" id="r_ab6227222ec220dcda67673e40b29a443"><td class="memItemLeft" align="right" valign="top"><a id="ab6227222ec220dcda67673e40b29a443" name="ab6227222ec220dcda67673e40b29a443"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>BENCHMARK_FN</b> (kernel_simd, { for(int i=1, k=0;i&lt; NBODIES;i++) { for(int j=0;j&lt; i;j++, k++) { r[k]=_mm256_sub_pd(positions[i], positions[j]);} } for(int k=0;k&lt; PAIRS;k+=4) { __m256d x0=_mm256_mul_pd(r[k], r[k]);__m256d x1=_mm256_mul_pd(r[k+1], r[k+1]);__m256d x2=_mm256_mul_pd(r[k+2], r[k+2]);__m256d x3=_mm256_mul_pd(r[k+3], r[k+3]);__m256d t0=_mm256_hadd_pd(x0, x1);__m256d t1=_mm256_hadd_pd(x2, x3);__m256d y0=_mm256_permute2f128_pd(t0, t1, 0x21);__m256d y1=_mm256_blend_pd(t0, t1, 0b1100);__m256d z=_mm256_add_pd(y0, y1);__m128 q=_mm256_cvtpd_ps(z);q=_mm_rsqrt_ps(q);__m256d x=_mm256_cvtps_pd(q);__m256d y=z *x *x;__m256d a=y *_mm256_set1_pd(0.375);a=a *y;__m256d b=y *_mm256_set1_pd(1.25);b=b - _mm256_set1_pd(1.875);z=a - b;z=x *z;_mm256_store_pd(w+k, z);} }) BENCHMARK_FN(energy_simd</td></tr>
<tr class="separator:ab6227222ec220dcda67673e40b29a443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf81ede63ad06a6b84e7a0f4abba1553" id="r_acf81ede63ad06a6b84e7a0f4abba1553"><td class="memItemLeft" align="right" valign="top"><a id="acf81ede63ad06a6b84e7a0f4abba1553" name="acf81ede63ad06a6b84e7a0f4abba1553"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>for</b> (int i=1, k=0;i&lt; NBODIES;i++)</td></tr>
<tr class="separator:acf81ede63ad06a6b84e7a0f4abba1553"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7415a18ce0dae8ad8b6b9e95af78dcf" id="r_af7415a18ce0dae8ad8b6b9e95af78dcf"><td class="memItemLeft" align="right" valign="top"><a id="af7415a18ce0dae8ad8b6b9e95af78dcf" name="af7415a18ce0dae8ad8b6b9e95af78dcf"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>BENCHMARK_FN</b> (advance_simd, { r[PAIRS]=_mm256_set1_pd(1.0);r[PAIRS+1]=_mm256_set1_pd(1.0);r[PAIRS+2]=_mm256_set1_pd(1.0);__m256d rt=_mm256_set1_pd(0.01);__m256d rm[NBODIES];for(int i=0;i&lt; NBODIES;i++) { rm[i]=_mm256_set1_pd(masses[i]);} for(int s=0;s&lt; NB_ITERS;s++) { for(int k=0;k&lt; PAIRS;k+=4) { __m256d x=_mm256_load_pd(w+k);__m256d y=x *x;__m256d z=x *rt;x=y *z;_mm256_store_pd(w+k, x);} for(int i=1, k=0;i&lt; NBODIES;i++) { for(int j=0;j&lt; i;j++, k++) { __m256d t=_mm256_set1_pd(w[k]);t=r[k] *t;__m256d x=t *rm[j];__m256d y=t *rm[i];velocities[i]=velocities[i] - x;velocities[j]=velocities[j]+y;} } for(int i=0;i&lt; NBODIES;i++) { __m256d t=velocities[i] *rt;positions[i]=positions[i]+t;} } }) int main()</td></tr>
<tr class="memdesc:af7415a18ce0dae8ad8b6b9e95af78dcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the benchmarks for the nbody problem. <br /></td></tr>
<tr class="separator:af7415a18ce0dae8ad8b6b9e95af78dcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a23b6c79d171747f67e8925d28d13b47e" id="r_a23b6c79d171747f67e8925d28d13b47e"><td class="memItemLeft" align="right" valign="top"><a id="a23b6c79d171747f67e8925d28d13b47e" name="a23b6c79d171747f67e8925d28d13b47e"></a>
constexpr int&#160;</td><td class="memItemRight" valign="bottom"><b>NBODIES</b> = 5</td></tr>
<tr class="separator:a23b6c79d171747f67e8925d28d13b47e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada858345792ec75f807df5162289468f" id="r_ada858345792ec75f807df5162289468f"><td class="memItemLeft" align="right" valign="top"><a id="ada858345792ec75f807df5162289468f" name="ada858345792ec75f807df5162289468f"></a>
<a class="el" href="structPlanet.html">Planet</a>&#160;</td><td class="memItemRight" valign="bottom"><b>bodies</b> [NBODIES]</td></tr>
<tr class="separator:ada858345792ec75f807df5162289468f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad29ba68eddcdfabc5dd4e8e213a0f5cd" id="r_ad29ba68eddcdfabc5dd4e8e213a0f5cd"><td class="memItemLeft" align="right" valign="top"><a id="ad29ba68eddcdfabc5dd4e8e213a0f5cd" name="ad29ba68eddcdfabc5dd4e8e213a0f5cd"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>py</b> = 0.0</td></tr>
<tr class="separator:ad29ba68eddcdfabc5dd4e8e213a0f5cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bc9242655b656456541637ff3a3b6b3" id="r_a2bc9242655b656456541637ff3a3b6b3"><td class="memItemLeft" align="right" valign="top"><a id="a2bc9242655b656456541637ff3a3b6b3" name="a2bc9242655b656456541637ff3a3b6b3"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>pz</b> = 0.0</td></tr>
<tr class="separator:a2bc9242655b656456541637ff3a3b6b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09869728ea673aa6639a42638ae78fd8" id="r_a09869728ea673aa6639a42638ae78fd8"><td class="memItemLeft" align="right" valign="top"><a id="a09869728ea673aa6639a42638ae78fd8" name="a09869728ea673aa6639a42638ae78fd8"></a>
bodies[0]&#160;</td><td class="memItemRight" valign="bottom"><b>vx</b> = -px / SOLAR_MASS</td></tr>
<tr class="separator:a09869728ea673aa6639a42638ae78fd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c6b22108dbbd5c39597239bb8c21c2e" id="r_a0c6b22108dbbd5c39597239bb8c21c2e"><td class="memItemLeft" align="right" valign="top"><a id="a0c6b22108dbbd5c39597239bb8c21c2e" name="a0c6b22108dbbd5c39597239bb8c21c2e"></a>
bodies[0]&#160;</td><td class="memItemRight" valign="bottom"><b>vy</b> = -py / SOLAR_MASS</td></tr>
<tr class="separator:a0c6b22108dbbd5c39597239bb8c21c2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad99729ab4e5ae3ef8347dab6468128f8" id="r_ad99729ab4e5ae3ef8347dab6468128f8"><td class="memItemLeft" align="right" valign="top"><a id="ad99729ab4e5ae3ef8347dab6468128f8" name="ad99729ab4e5ae3ef8347dab6468128f8"></a>
bodies[0]&#160;</td><td class="memItemRight" valign="bottom"><b>vz</b> = -pz / SOLAR_MASS</td></tr>
<tr class="separator:ad99729ab4e5ae3ef8347dab6468128f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a210d2a667b0e5a0fb2815459fd05eba5" id="r_a210d2a667b0e5a0fb2815459fd05eba5"><td class="memItemLeft" align="right" valign="top"><a id="a210d2a667b0e5a0fb2815459fd05eba5" name="a210d2a667b0e5a0fb2815459fd05eba5"></a>
constexpr int&#160;</td><td class="memItemRight" valign="bottom"><b>NB_ITERS</b> = 1000</td></tr>
<tr class="separator:a210d2a667b0e5a0fb2815459fd05eba5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a980c3fb652b765bd9a0ae32401dc09e5" id="r_a980c3fb652b765bd9a0ae32401dc09e5"><td class="memItemLeft" align="right" valign="top"><a id="a980c3fb652b765bd9a0ae32401dc09e5" name="a980c3fb652b765bd9a0ae32401dc09e5"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>masses</b> [NBODIES]</td></tr>
<tr class="separator:a980c3fb652b765bd9a0ae32401dc09e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab49f70ba3a6f0eb5a4ee1f09a65215bd" id="r_ab49f70ba3a6f0eb5a4ee1f09a65215bd"><td class="memItemLeft" align="right" valign="top"><a id="ab49f70ba3a6f0eb5a4ee1f09a65215bd" name="ab49f70ba3a6f0eb5a4ee1f09a65215bd"></a>
__m256d&#160;</td><td class="memItemRight" valign="bottom"><b>positions</b> [NBODIES]</td></tr>
<tr class="separator:ab49f70ba3a6f0eb5a4ee1f09a65215bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf57a10a5848c05feaadc6f7fa56230c" id="r_abf57a10a5848c05feaadc6f7fa56230c"><td class="memItemLeft" align="right" valign="top"><a id="abf57a10a5848c05feaadc6f7fa56230c" name="abf57a10a5848c05feaadc6f7fa56230c"></a>
__m256d&#160;</td><td class="memItemRight" valign="bottom"><b>velocities</b> [NBODIES]</td></tr>
<tr class="separator:abf57a10a5848c05feaadc6f7fa56230c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25ed1bcb423b0b7200f485fc5ff71c8e" id="r_a25ed1bcb423b0b7200f485fc5ff71c8e"><td class="memItemLeft" align="right" valign="top"><a id="a25ed1bcb423b0b7200f485fc5ff71c8e" name="a25ed1bcb423b0b7200f485fc5ff71c8e"></a>
__m256d&#160;</td><td class="memItemRight" valign="bottom"><b>z</b> = x</td></tr>
<tr class="separator:a25ed1bcb423b0b7200f485fc5ff71c8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a099b3b060154898840f0ebdfb46ec78f" id="r_a099b3b060154898840f0ebdfb46ec78f"><td class="memItemLeft" align="right" valign="top"><a id="a099b3b060154898840f0ebdfb46ec78f" name="a099b3b060154898840f0ebdfb46ec78f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>q</b> = _mm_rsqrt_ps(q)</td></tr>
<tr class="separator:a099b3b060154898840f0ebdfb46ec78f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9336ebf25087d91c818ee6e9ec29f8c1" id="r_a9336ebf25087d91c818ee6e9ec29f8c1"><td class="memItemLeft" align="right" valign="top"><a id="a9336ebf25087d91c818ee6e9ec29f8c1" name="a9336ebf25087d91c818ee6e9ec29f8c1"></a>
__m256d&#160;</td><td class="memItemRight" valign="bottom"><b>x</b> = _mm256_cvtps_pd(q)</td></tr>
<tr class="separator:a9336ebf25087d91c818ee6e9ec29f8c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fb1c5cf58867b5bbc9a1b145a86f3a0" id="r_a2fb1c5cf58867b5bbc9a1b145a86f3a0"><td class="memItemLeft" align="right" valign="top"><a id="a2fb1c5cf58867b5bbc9a1b145a86f3a0" name="a2fb1c5cf58867b5bbc9a1b145a86f3a0"></a>
__m256d&#160;</td><td class="memItemRight" valign="bottom"><b>y</b> = positions[0] * x * x</td></tr>
<tr class="separator:a2fb1c5cf58867b5bbc9a1b145a86f3a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4124bc0a9335c27f086f24ba207a4912" id="r_a4124bc0a9335c27f086f24ba207a4912"><td class="memItemLeft" align="right" valign="top"><a id="a4124bc0a9335c27f086f24ba207a4912" name="a4124bc0a9335c27f086f24ba207a4912"></a>
__m256d&#160;</td><td class="memItemRight" valign="bottom"><b>a</b> = y * _mm256_set1_pd(0.375)</td></tr>
<tr class="separator:a4124bc0a9335c27f086f24ba207a4912"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21ad0bd836b90d08f4cf640b4c298e7c" id="r_a21ad0bd836b90d08f4cf640b4c298e7c"><td class="memItemLeft" align="right" valign="top"><a id="a21ad0bd836b90d08f4cf640b4c298e7c" name="a21ad0bd836b90d08f4cf640b4c298e7c"></a>
__m256d&#160;</td><td class="memItemRight" valign="bottom"><b>b</b> = y * _mm256_set1_pd(1.25)</td></tr>
<tr class="separator:a21ad0bd836b90d08f4cf640b4c298e7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a341035163730b5e3ce7c9ae1f84a8404" id="r_a341035163730b5e3ce7c9ae1f84a8404"><td class="memItemLeft" align="right" valign="top">__m256d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a341035163730b5e3ce7c9ae1f84a8404">r</a> [PAIRS+3]</td></tr>
<tr class="separator:a341035163730b5e3ce7c9ae1f84a8404"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae52cb31c0a82595a74ba77dc30d7cbd" id="r_aae52cb31c0a82595a74ba77dc30d7cbd"><td class="memItemLeft" align="right" valign="top"><a id="aae52cb31c0a82595a74ba77dc30d7cbd" name="aae52cb31c0a82595a74ba77dc30d7cbd"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>energy_result</b> = e</td></tr>
<tr class="separator:aae52cb31c0a82595a74ba77dc30d7cbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Benchmark for the nbody problem. </p>
</div><h2 class="groupheader">Variable Documentation</h2>
<a id="a341035163730b5e3ce7c9ae1f84a8404" name="a341035163730b5e3ce7c9ae1f84a8404"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a341035163730b5e3ce7c9ae1f84a8404">&#9670;&#160;</a></span>r</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">r[PAIRS+2]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordtype">double</span> e = 0.0</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
