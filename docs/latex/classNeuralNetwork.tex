\doxysection{Neural\+Network Class Reference}
\hypertarget{classNeuralNetwork}{}\label{classNeuralNetwork}\index{NeuralNetwork@{NeuralNetwork}}


Class representing a neural network.  




{\ttfamily \#include $<$neural\+\_\+network.\+hpp$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classNeuralNetwork_a0f6d0cd58e503f1aa6c9c6ce64fd09fb}{Neural\+Network}} (std\+::vector$<$ size\+\_\+t $>$ \&topology, float learning\+\_\+rate, std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classActivationFunc}{Activation\+Func}} $>$ activation\+\_\+func)
\begin{DoxyCompactList}\small\item\em Construct a new \doxylink{classNeuralNetwork}{Neural\+Network} object. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classNeuralNetwork_afc8cc8842356b25617cea788c82ec6c9}{train}} (\mbox{\hyperlink{classDataset}{Dataset}} \&dataset, int nb\+\_\+epochs, float training\+\_\+proportion, std\+::string \&\&logging\+\_\+dir, int nb\+\_\+trains)
\begin{DoxyCompactList}\small\item\em Train the neural network. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classNeuralNetwork_a106445ed72cb3ae7bc85f99cc28b9a62}{train\+\_\+batch}} (\mbox{\hyperlink{classDataset}{Dataset}} \&dataset, int nb\+\_\+epochs, float training\+\_\+proportion, float rolling\+\_\+proportion, std\+::string \&\&logging\+\_\+dir, int nb\+\_\+trains)
\begin{DoxyCompactList}\small\item\em Train the neural network. \end{DoxyCompactList}\item 
Eigen\+::\+Vector\+Xf \mbox{\hyperlink{classNeuralNetwork_a26155d14e8c97c786614843494397d16}{get\+\_\+prediction}} (const Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*}input)
\begin{DoxyCompactList}\small\item\em Get the prediction of the network. \end{DoxyCompactList}\item 
\Hypertarget{classNeuralNetwork_af1308079bed0cc76d6995c120bad0284}\label{classNeuralNetwork_af1308079bed0cc76d6995c120bad0284} 
std\+::vector$<$ float $>$ {\bfseries get\+\_\+prediction} (const std\+::vector$<$ float $>$ \&input)
\item 
std\+::pair$<$ std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$, std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ $>$ \mbox{\hyperlink{classNeuralNetwork_adc488c9cff4768932aa59aed9bca51ad}{convert\+\_\+data\+\_\+for\+\_\+loss}} (std\+::vector$<$ std\+::vector$<$ float $>$ $>$ \&inputs, std\+::vector$<$ std\+::vector$<$ float $>$ $>$ \&targets)
\begin{DoxyCompactList}\small\item\em Convert input data and target data to correct format to compute loss and accuracy. \end{DoxyCompactList}\item 
\Hypertarget{classNeuralNetwork_a6e8b9fe32d14612fde5e30d836d82be7}\label{classNeuralNetwork_a6e8b9fe32d14612fde5e30d836d82be7} 
std\+::pair$<$ std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$, std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ $>$ {\bfseries convert\+\_\+data\+\_\+for\+\_\+loss} (std\+::vector$<$ Eigen\+::\+Vector\+Xf $>$ \&inputs, std\+::vector$<$ Eigen\+::\+Vector\+Xf $>$ \&targets)
\item 
\Hypertarget{classNeuralNetwork_a113881945d8ac4d5d41273f502799290}\label{classNeuralNetwork_a113881945d8ac4d5d41273f502799290} 
std\+::pair$<$ std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$, std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ $>$ {\bfseries convert\+\_\+data\+\_\+for\+\_\+loss} (\mbox{\hyperlink{classDataset}{Dataset}} \&dataset)
\item 
double \mbox{\hyperlink{classNeuralNetwork_afb258de0e9efb180c1c7e45c801c3342}{get\+\_\+loss\+\_\+mrse}} (std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&inputs, std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&targets, \mbox{\hyperlink{classIEncoder}{IEncoder}} \texorpdfstring{$\ast$}{*}encoder)
\begin{DoxyCompactList}\small\item\em Get the loss of the network, uses mean relative squared error. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classNeuralNetwork_a13d52c1ba7753a9975a6928af7c1e9c4}{get\+\_\+loss\+\_\+mse}} (std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&inputs, std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&targets, \mbox{\hyperlink{classIEncoder}{IEncoder}} \texorpdfstring{$\ast$}{*}encoder)
\begin{DoxyCompactList}\small\item\em Get the loss of the network, uses mean squared error. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classNeuralNetwork_ac2dcf7c4974cc5f6f0cc18d32314d6fc}{get\+\_\+acc\+\_\+mae}} (std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&inputs, std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&targets, \mbox{\hyperlink{classIEncoder}{IEncoder}} \texorpdfstring{$\ast$}{*}encoder)
\begin{DoxyCompactList}\small\item\em Get the accuracy of the network, uses mean absolute error. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classNeuralNetwork_aca0e2e1314d81aa0b41c64d501d92614}{get\+\_\+acc\+\_\+mrae}} (std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&inputs, std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&targets, \mbox{\hyperlink{classIEncoder}{IEncoder}} \texorpdfstring{$\ast$}{*}encoder)
\begin{DoxyCompactList}\small\item\em Get the accuracy of the network, uses mean relative absolute error. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Class representing a neural network. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classNeuralNetwork_a0f6d0cd58e503f1aa6c9c6ce64fd09fb}\label{classNeuralNetwork_a0f6d0cd58e503f1aa6c9c6ce64fd09fb} 
\index{NeuralNetwork@{NeuralNetwork}!NeuralNetwork@{NeuralNetwork}}
\index{NeuralNetwork@{NeuralNetwork}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{NeuralNetwork()}{NeuralNetwork()}}
{\footnotesize\ttfamily Neural\+Network\+::\+Neural\+Network (\begin{DoxyParamCaption}\item[{std\+::vector$<$ size\+\_\+t $>$ \&}]{topology,  }\item[{float}]{learning\+\_\+rate,  }\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classActivationFunc}{Activation\+Func}} $>$}]{activation\+\_\+func }\end{DoxyParamCaption})}



Construct a new \doxylink{classNeuralNetwork}{Neural\+Network} object. 


\begin{DoxyParams}{Parameters}
{\em topology} & The number of neurons in each layer \\
\hline
{\em learning\+\_\+rate} & The learning rate of the network \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\Hypertarget{classNeuralNetwork_adc488c9cff4768932aa59aed9bca51ad}\label{classNeuralNetwork_adc488c9cff4768932aa59aed9bca51ad} 
\index{NeuralNetwork@{NeuralNetwork}!convert\_data\_for\_loss@{convert\_data\_for\_loss}}
\index{convert\_data\_for\_loss@{convert\_data\_for\_loss}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{convert\_data\_for\_loss()}{convert\_data\_for\_loss()}}
{\footnotesize\ttfamily std\+::pair$<$ std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$, std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ $>$ Neural\+Network\+::convert\+\_\+data\+\_\+for\+\_\+loss (\begin{DoxyParamCaption}\item[{std\+::vector$<$ std\+::vector$<$ float $>$ $>$ \&}]{inputs,  }\item[{std\+::vector$<$ std\+::vector$<$ float $>$ $>$ \&}]{targets }\end{DoxyParamCaption})}



Convert input data and target data to correct format to compute loss and accuracy. 


\begin{DoxyParams}{Parameters}
{\em inputs} & The input data \\
\hline
{\em targets} & The target output data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The loss of the network 
\end{DoxyReturn}
\Hypertarget{classNeuralNetwork_ac2dcf7c4974cc5f6f0cc18d32314d6fc}\label{classNeuralNetwork_ac2dcf7c4974cc5f6f0cc18d32314d6fc} 
\index{NeuralNetwork@{NeuralNetwork}!get\_acc\_mae@{get\_acc\_mae}}
\index{get\_acc\_mae@{get\_acc\_mae}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{get\_acc\_mae()}{get\_acc\_mae()}}
{\footnotesize\ttfamily double Neural\+Network\+::get\+\_\+acc\+\_\+mae (\begin{DoxyParamCaption}\item[{std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&}]{inputs,  }\item[{std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&}]{targets,  }\item[{\mbox{\hyperlink{classIEncoder}{IEncoder}} \texorpdfstring{$\ast$}{*}}]{encoder }\end{DoxyParamCaption})}



Get the accuracy of the network, uses mean absolute error. 


\begin{DoxyParams}{Parameters}
{\em inputs} & The input data \\
\hline
{\em targets} & The target output data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The accuracy of the network 
\end{DoxyReturn}
\Hypertarget{classNeuralNetwork_aca0e2e1314d81aa0b41c64d501d92614}\label{classNeuralNetwork_aca0e2e1314d81aa0b41c64d501d92614} 
\index{NeuralNetwork@{NeuralNetwork}!get\_acc\_mrae@{get\_acc\_mrae}}
\index{get\_acc\_mrae@{get\_acc\_mrae}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{get\_acc\_mrae()}{get\_acc\_mrae()}}
{\footnotesize\ttfamily double Neural\+Network\+::get\+\_\+acc\+\_\+mrae (\begin{DoxyParamCaption}\item[{std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&}]{inputs,  }\item[{std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&}]{targets,  }\item[{\mbox{\hyperlink{classIEncoder}{IEncoder}} \texorpdfstring{$\ast$}{*}}]{encoder }\end{DoxyParamCaption})}



Get the accuracy of the network, uses mean relative absolute error. 


\begin{DoxyParams}{Parameters}
{\em inputs} & The input data \\
\hline
{\em targets} & The target output data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The accuracy of the network 
\end{DoxyReturn}
\Hypertarget{classNeuralNetwork_afb258de0e9efb180c1c7e45c801c3342}\label{classNeuralNetwork_afb258de0e9efb180c1c7e45c801c3342} 
\index{NeuralNetwork@{NeuralNetwork}!get\_loss\_mrse@{get\_loss\_mrse}}
\index{get\_loss\_mrse@{get\_loss\_mrse}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{get\_loss\_mrse()}{get\_loss\_mrse()}}
{\footnotesize\ttfamily double Neural\+Network\+::get\+\_\+loss\+\_\+mrse (\begin{DoxyParamCaption}\item[{std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&}]{inputs,  }\item[{std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&}]{targets,  }\item[{\mbox{\hyperlink{classIEncoder}{IEncoder}} \texorpdfstring{$\ast$}{*}}]{encoder }\end{DoxyParamCaption})}



Get the loss of the network, uses mean relative squared error. 


\begin{DoxyParams}{Parameters}
{\em inputs} & The input data \\
\hline
{\em targets} & The target output data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The loss of the network 
\end{DoxyReturn}
\Hypertarget{classNeuralNetwork_a13d52c1ba7753a9975a6928af7c1e9c4}\label{classNeuralNetwork_a13d52c1ba7753a9975a6928af7c1e9c4} 
\index{NeuralNetwork@{NeuralNetwork}!get\_loss\_mse@{get\_loss\_mse}}
\index{get\_loss\_mse@{get\_loss\_mse}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{get\_loss\_mse()}{get\_loss\_mse()}}
{\footnotesize\ttfamily double Neural\+Network\+::get\+\_\+loss\+\_\+mse (\begin{DoxyParamCaption}\item[{std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&}]{inputs,  }\item[{std\+::vector$<$ Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*} $>$ \&}]{targets,  }\item[{\mbox{\hyperlink{classIEncoder}{IEncoder}} \texorpdfstring{$\ast$}{*}}]{encoder }\end{DoxyParamCaption})}



Get the loss of the network, uses mean squared error. 


\begin{DoxyParams}{Parameters}
{\em inputs} & The input data \\
\hline
{\em targets} & The target output data \\
\hline
\end{DoxyParams}
\Hypertarget{classNeuralNetwork_a26155d14e8c97c786614843494397d16}\label{classNeuralNetwork_a26155d14e8c97c786614843494397d16} 
\index{NeuralNetwork@{NeuralNetwork}!get\_prediction@{get\_prediction}}
\index{get\_prediction@{get\_prediction}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{get\_prediction()}{get\_prediction()}}
{\footnotesize\ttfamily Eigen\+::\+Vector\+Xf Neural\+Network\+::get\+\_\+prediction (\begin{DoxyParamCaption}\item[{const Eigen\+::\+Vector\+Xf \texorpdfstring{$\ast$}{*}}]{input }\end{DoxyParamCaption})}



Get the prediction of the network. 


\begin{DoxyParams}{Parameters}
{\em input} & The input to the network \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The prediction of the network 
\end{DoxyReturn}
\Hypertarget{classNeuralNetwork_afc8cc8842356b25617cea788c82ec6c9}\label{classNeuralNetwork_afc8cc8842356b25617cea788c82ec6c9} 
\index{NeuralNetwork@{NeuralNetwork}!train@{train}}
\index{train@{train}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{train()}{train()}}
{\footnotesize\ttfamily void Neural\+Network\+::train (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classDataset}{Dataset}} \&}]{dataset,  }\item[{int}]{nb\+\_\+epochs,  }\item[{float}]{training\+\_\+proportion,  }\item[{std\+::string \&\&}]{logging\+\_\+dir,  }\item[{int}]{nb\+\_\+trains }\end{DoxyParamCaption})}



Train the neural network. 


\begin{DoxyParams}{Parameters}
{\em dataset} & The dataset to train on \\
\hline
{\em nb\+\_\+epochs} & The number of epochs to train for \\
\hline
{\em training\+\_\+proportion} & the proportion of inputs to be used as training data (from 0 for no training data, to 1 for all training data), the rest will be used as validation data \\
\hline
{\em logging\+\_\+dir} & The directory to save the logs \\
\hline
{\em nb\+\_\+trains} & The number of times to train the network \\
\hline
\end{DoxyParams}
\Hypertarget{classNeuralNetwork_a106445ed72cb3ae7bc85f99cc28b9a62}\label{classNeuralNetwork_a106445ed72cb3ae7bc85f99cc28b9a62} 
\index{NeuralNetwork@{NeuralNetwork}!train\_batch@{train\_batch}}
\index{train\_batch@{train\_batch}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{train\_batch()}{train\_batch()}}
{\footnotesize\ttfamily void Neural\+Network\+::train\+\_\+batch (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classDataset}{Dataset}} \&}]{dataset,  }\item[{int}]{nb\+\_\+epochs,  }\item[{float}]{training\+\_\+proportion,  }\item[{float}]{rolling\+\_\+proportion,  }\item[{std\+::string \&\&}]{logging\+\_\+dir,  }\item[{int}]{nb\+\_\+trains }\end{DoxyParamCaption})}



Train the neural network. 


\begin{DoxyParams}{Parameters}
{\em dataset} & The dataset to train on \\
\hline
{\em nb\+\_\+epochs} & The number of epochs to train for \\
\hline
{\em training\+\_\+proportion} & the proportion of inputs to be used as training data (from 0 for no training data, to 1 for all training data), the rest will be used as validation data \\
\hline
{\em rolling\+\_\+proportion} & The proportion of the training data to be used in each epoch \\
\hline
{\em logging\+\_\+dir} & The directory to save the logs \\
\hline
{\em nb\+\_\+trains} & The number of times to train the network \\
\hline
\end{DoxyParams}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
include/neural\+\_\+network/\mbox{\hyperlink{neural__network_8hpp}{neural\+\_\+network.\+hpp}}\item 
src/neural\+\_\+network/\mbox{\hyperlink{neural__network_8cpp}{neural\+\_\+network.\+cpp}}\end{DoxyCompactItemize}
